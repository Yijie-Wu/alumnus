import{_ as V,r as c,u as k,j as U,D as f,b as s,o as i,c as g,e as o,w as l,F as R,h as A,f as B,g as C,i as q}from"./index-CJd5nHo2.js";import{f as z}from"./user-D9452C-O.js";import{u as F,g as M}from"./role-DG0K_Lgs.js";import{s as d}from"./request-vRFKru4k.js";import{u as N}from"./user-C4c4RE7V.js";const S={class:"container"},j={__name:"UserAdd",setup(D){c([]);const p=c(null),b=k();N();const _=F();U(()=>{M().then(a=>{_.setRoles(a.data)}).catch(a=>{d("error","获取角色列表失败")})});const r=f({role_id:"",username:""}),y=f({role_id:[{required:!0,message:"请选择用户角色",trigger:"blur"}],username:[{required:!0,message:"用户名称不能为空",trigger:"blur"},{min:1,max:20,message:"用户名称长度必须在1到20之间",trigger:"blur"}]}),x=a=>{a.validate(e=>{if(!e)return!1;let u={role_id:r.role_id,username:r.username};z(u).then(n=>{d("success","添加用户成功"),b.push("/admin/users/list")}).catch(n=>{d("error",n.message)})})};return(a,e)=>{const u=s("el-option"),n=s("el-select"),m=s("el-form-item"),v=s("el-input"),w=s("el-button"),h=s("el-form");return i(),g("div",S,[o(h,{ref_key:"formRef",ref:p,model:r,rules:y,style:{width:"100%"},"label-width":"auto","label-position":"left"},{default:l(()=>[o(m,{style:{"margin-top":"20px"},prop:"role_id",label:"用户角色"},{default:l(()=>[o(n,{modelValue:r.role_id,"onUpdate:modelValue":e[0]||(e[0]=t=>r.role_id=t),style:{width:"60%","min-width":"200px"}},{default:l(()=>[(i(!0),g(R,null,A(B(_).roles,t=>(i(),q(u,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(m,{style:{"margin-top":"10px"},prop:"username",label:"用户名称"},{default:l(()=>[o(v,{modelValue:r.username,"onUpdate:modelValue":e[1]||(e[1]=t=>r.username=t),class:"w-50 m-2",placeholder:"用户名称",size:"large",type:"text"},null,8,["modelValue"])]),_:1}),o(m,{style:{"margin-top":"50px"},type:"submit"},{default:l(()=>[o(w,{type:"primary",onClick:e[2]||(e[2]=t=>x(p.value)),plain:"",style:{width:"100%"},size:"large",round:""},{default:l(()=>e[3]||(e[3]=[C("创建新用户")])),_:1})]),_:1})]),_:1},8,["model","rules"])])}}},G=V(j,[["__scopeId","data-v-ca4befea"]]);export{G as default};
